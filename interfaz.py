# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file 'StellarPixelsGUI.ui'
#
# Created by: PyQt5 UI code generator 5.15.11
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.


from PyQt5 import QtCore, QtGui, QtWidgets
from PyQt5.QtWidgets import QApplication, QGraphicsView, QGraphicsScene, QGraphicsPixmapItem
from PyQt5.QtGui import QPixmap, QImage, QPainter
from PyQt5.QtCore import Qt
from PIL import Image
import sys

class ImageViewer(QtWidgets.QGraphicsView):
    zoomChanged = QtCore.pyqtSignal()
    
    def __init__(self, parent=None):
        super(ImageViewer, self).__init__(parent)
        self.scene = QtWidgets.QGraphicsScene(self)
        self.setScene(self.scene)

        # Configuración para alta calidad
        self.setRenderHint(QtGui.QPainter.Antialiasing, True)
        self.setRenderHint(QtGui.QPainter.SmoothPixmapTransform, True)
        self.setDragMode(QtWidgets.QGraphicsView.ScrollHandDrag)
        self.setTransformationAnchor(QtWidgets.QGraphicsView.AnchorUnderMouse)
        self.setDragMode(QtWidgets.QGraphicsView.NoDrag)  # moviento bloqueado por defecto
        self.scale_factor = 1.0
        
        self.setHorizontalScrollBarPolicy(Qt.ScrollBarAlwaysOff)
        self.setVerticalScrollBarPolicy(Qt.ScrollBarAlwaysOff)


    def zoom_in(self):
        zoom_factor = 1.25
        self.scale(zoom_factor, zoom_factor)
        self.scale_factor *= zoom_factor
        self.zoomChanged.emit()

    def zoom_out(self):
        zoom_factor = 1 / 1.25
        self.scale(zoom_factor, zoom_factor)
        self.scale_factor *= zoom_factor
        self.zoomChanged.emit()

    def refresh_zoom(self):
        """Restaura el tamaño original"""
        self.resetTransform()
        bounds = self.scene.itemsBoundingRect()
        self.scene.setSceneRect(bounds)
        self.fitInView(bounds, QtCore.Qt.KeepAspectRatio)
        self.scale_factor = 1.0
        self.zoomChanged.emit()
        

    def load_image(self, image_path):
        """Carga una imagen TIFF con máxima calidad"""
        image = QtGui.QImage(image_path)
        if image.isNull():
            QtWidgets.QMessageBox.warning(self, "Error", f"No se pudo abrir la imagen:\n{image_path}")
            return

        pixmap = QtGui.QPixmap.fromImage(image)
        self.scene.clear()
        item = self.scene.addPixmap(pixmap)
        bounds = self.scene.itemsBoundingRect()
        self.scene.setSceneRect(bounds)

        self.fitInView(bounds, QtCore.Qt.KeepAspectRatio)
        self.scale_factor = 1.0

    def wheelEvent(self, event):
        """Zoom con la rueda del ratón"""
        zoom_in_factor = 1.25
        zoom_out_factor = 1 / zoom_in_factor

        if event.angleDelta().y() > 0:
            zoom_factor = zoom_in_factor
        else:
            zoom_factor = zoom_out_factor

        self.scale(zoom_factor, zoom_factor)
        self.scale_factor *= zoom_factor
        self.zoomChanged.emit()



class Ui_MainWindow(object):
    def setupUi(self, MainWindow):
        MainWindow.setObjectName("MainWindow")
        MainWindow.setEnabled(True)
        MainWindow.resize(1226, 704)
        MainWindow.setTabShape(QtWidgets.QTabWidget.Rounded)
        self.centralwidget = QtWidgets.QWidget(MainWindow)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Preferred, QtWidgets.QSizePolicy.Preferred)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.centralwidget.sizePolicy().hasHeightForWidth())
        self.centralwidget.setSizePolicy(sizePolicy)
        self.centralwidget.setStyleSheet("background-color:rgb(40,40,35)")
        self.centralwidget.setObjectName("centralwidget")
        self.verticalLayout = QtWidgets.QVBoxLayout(self.centralwidget)
        self.verticalLayout.setContentsMargins(0, 0, 0, 0)
        self.verticalLayout.setSpacing(0)
        self.verticalLayout.setObjectName("verticalLayout")
        self.frameSuperior = QtWidgets.QFrame(self.centralwidget)
        self.frameSuperior.setStyleSheet("background-color: rgb(24, 24, 24);\n"
"")
        self.frameSuperior.setFrameShape(QtWidgets.QFrame.StyledPanel)
        self.frameSuperior.setFrameShadow(QtWidgets.QFrame.Raised)
        self.frameSuperior.setObjectName("frameSuperior")
        self.horizontalLayout_6 = QtWidgets.QHBoxLayout(self.frameSuperior)
        self.horizontalLayout_6.setContentsMargins(0, 0, 10, 0)
        self.horizontalLayout_6.setSpacing(0)
        self.horizontalLayout_6.setObjectName("horizontalLayout_6")
        self.frameTitulo = QtWidgets.QFrame(self.frameSuperior)
        font = QtGui.QFont()
        font.setPointSize(15)
        self.frameTitulo.setFont(font)
        self.frameTitulo.setStyleSheet("")
        self.frameTitulo.setFrameShape(QtWidgets.QFrame.StyledPanel)
        self.frameTitulo.setFrameShadow(QtWidgets.QFrame.Raised)
        self.frameTitulo.setObjectName("frameTitulo")
        self.horizontalLayout_5 = QtWidgets.QHBoxLayout(self.frameTitulo)
        self.horizontalLayout_5.setContentsMargins(-1, -1, -1, 9)
        self.horizontalLayout_5.setObjectName("horizontalLayout_5")
        self.lblTitulo = QtWidgets.QLabel(self.frameTitulo)
        font = QtGui.QFont()
        font.setPointSize(18)
        font.setBold(True)
        font.setWeight(75)
        self.lblTitulo.setFont(font)
        self.lblTitulo.setStyleSheet("color:rgb(255, 255, 255)")
        self.lblTitulo.setObjectName("lblTitulo")
        self.horizontalLayout_5.addWidget(self.lblTitulo)
        self.horizontalLayout_6.addWidget(self.frameTitulo)
        self.frameBuscador = QtWidgets.QFrame(self.frameSuperior)
        self.frameBuscador.setStyleSheet("")
        self.frameBuscador.setFrameShape(QtWidgets.QFrame.StyledPanel)
        self.frameBuscador.setFrameShadow(QtWidgets.QFrame.Raised)
        self.frameBuscador.setObjectName("frameBuscador")
        self.horizontalLayout_7 = QtWidgets.QHBoxLayout(self.frameBuscador)
        self.horizontalLayout_7.setObjectName("horizontalLayout_7")
        self.lineEdit = QtWidgets.QLineEdit(self.frameBuscador)
        self.lineEdit.setStyleSheet("background-color:rgb(255, 255, 255)")
        self.lineEdit.setObjectName("lineEdit")
        self.horizontalLayout_7.addWidget(self.lineEdit)
        self.horizontalLayout_6.addWidget(self.frameBuscador)
        self.horizontalLayout_6.setStretch(0, 8)
        self.horizontalLayout_6.setStretch(1, 2)
        self.verticalLayout.addWidget(self.frameSuperior)
        self.framePaneles = QtWidgets.QFrame(self.centralwidget)
        self.framePaneles.setFrameShape(QtWidgets.QFrame.StyledPanel)
        self.framePaneles.setFrameShadow(QtWidgets.QFrame.Raised)
        self.framePaneles.setObjectName("framePaneles")
        self.horizontalLayout = QtWidgets.QHBoxLayout(self.framePaneles)
        self.horizontalLayout.setContentsMargins(0, 0, 0, 0)
        self.horizontalLayout.setSpacing(0)
        self.horizontalLayout.setObjectName("horizontalLayout")
        self.panelHerramientas = QtWidgets.QFrame(self.framePaneles)
        self.panelHerramientas.setStyleSheet("background:rgb(14, 14, 14)")
        self.panelHerramientas.setFrameShape(QtWidgets.QFrame.StyledPanel)
        self.panelHerramientas.setFrameShadow(QtWidgets.QFrame.Raised)
        self.panelHerramientas.setObjectName("panelHerramientas")
        self.horizontalLayout_2 = QtWidgets.QHBoxLayout(self.panelHerramientas)
        self.horizontalLayout_2.setContentsMargins(0, 0, 0, 0)
        self.horizontalLayout_2.setSpacing(0)
        self.horizontalLayout_2.setObjectName("horizontalLayout_2")
        self.seccionesControles = QtWidgets.QFrame(self.panelHerramientas)
        self.seccionesControles.setStyleSheet("background-color: rgb(34, 34, 34)\n"
"")
        self.seccionesControles.setFrameShape(QtWidgets.QFrame.StyledPanel)
        self.seccionesControles.setFrameShadow(QtWidgets.QFrame.Raised)
        self.seccionesControles.setObjectName("seccionesControles")
        self.verticalLayout_2 = QtWidgets.QVBoxLayout(self.seccionesControles)
        self.verticalLayout_2.setObjectName("verticalLayout_2")
        self.panelBotones = QtWidgets.QFrame(self.seccionesControles)
        self.panelBotones.setFrameShape(QtWidgets.QFrame.StyledPanel)
        self.panelBotones.setFrameShadow(QtWidgets.QFrame.Raised)
        self.panelBotones.setObjectName("panelBotones")
        self.verticalLayout_4 = QtWidgets.QVBoxLayout(self.panelBotones)
        self.verticalLayout_4.setObjectName("verticalLayout_4")
        self.label = QtWidgets.QLabel(self.panelBotones)
        font = QtGui.QFont()
        font.setPointSize(12)
        font.setBold(True)
        font.setWeight(75)
        self.label.setFont(font)
        self.label.setStyleSheet("color:rgb(255, 255, 255)")
        self.label.setObjectName("label")
        self.verticalLayout_4.addWidget(self.label)
        self.frame = QtWidgets.QFrame(self.panelBotones)
        self.frame.setFrameShape(QtWidgets.QFrame.StyledPanel)
        self.frame.setFrameShadow(QtWidgets.QFrame.Raised)
        self.frame.setObjectName("frame")
        self.horizontalLayout_4 = QtWidgets.QHBoxLayout(self.frame)
        self.horizontalLayout_4.setObjectName("horizontalLayout_4")
        self.bttnCursor = QtWidgets.QToolButton(self.frame)
        icon = QtGui.QIcon()
        icon.addPixmap(QtGui.QPixmap("iconos/flecha-de-ubicacion.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.bttnCursor.setIcon(icon)
        self.bttnCursor.setObjectName("bttnCursor")
        self.horizontalLayout_4.addWidget(self.bttnCursor)
        self.bttnCursor.clicked.connect(lambda: self.viewer.setDragMode(QtWidgets.QGraphicsView.NoDrag))
        self.bttnMover = QtWidgets.QToolButton(self.frame)
        icon1 = QtGui.QIcon()
        icon1.addPixmap(QtGui.QPixmap("iconos/flechas.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.bttnMover.setIcon(icon1)
        self.bttnMover.setObjectName("bttnMover")
        self.bttnMover.clicked.connect(lambda: self.viewer.setDragMode(QtWidgets.QGraphicsView.ScrollHandDrag))
        self.horizontalLayout_4.addWidget(self.bttnMover)
        self.bttnCortar = QtWidgets.QToolButton(self.frame)
        icon2 = QtGui.QIcon()
        icon2.addPixmap(QtGui.QPixmap("iconos/cultivo-de-herramientas.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.bttnCortar.setIcon(icon2)
        self.bttnCortar.setObjectName("bttnCortar")
        self.horizontalLayout_4.addWidget(self.bttnCortar)
        self.verticalLayout_4.addWidget(self.frame)
        self.verticalLayout_4.setStretch(0, 1)
        self.verticalLayout_4.setStretch(1, 2)
        self.verticalLayout_2.addWidget(self.panelBotones)
        self.panelSliders = QtWidgets.QFrame(self.seccionesControles)
        self.panelSliders.setFrameShape(QtWidgets.QFrame.StyledPanel)
        self.panelSliders.setFrameShadow(QtWidgets.QFrame.Raised)
        self.panelSliders.setObjectName("panelSliders")
        self.verticalLayout_5 = QtWidgets.QVBoxLayout(self.panelSliders)
        self.verticalLayout_5.setObjectName("verticalLayout_5")
        self.subtituloSliders = QtWidgets.QLabel(self.panelSliders)
        font = QtGui.QFont()
        font.setPointSize(12)
        font.setBold(True)
        font.setWeight(75)
        self.subtituloSliders.setFont(font)
        self.subtituloSliders.setStyleSheet("color:rgb(255, 255, 255)")
        self.subtituloSliders.setObjectName("subtituloSliders")
        self.verticalLayout_5.addWidget(self.subtituloSliders)
        self.lblBrillo = QtWidgets.QLabel(self.panelSliders)
        font = QtGui.QFont()
        font.setPointSize(10)
        self.lblBrillo.setFont(font)
        self.lblBrillo.setStyleSheet("color:rgb(255, 255, 255)")
        self.lblBrillo.setObjectName("lblBrillo")
        self.verticalLayout_5.addWidget(self.lblBrillo)
        self.sldrBrillo = QtWidgets.QSlider(self.panelSliders)
        self.sldrBrillo.setStyleSheet("")
        self.sldrBrillo.setOrientation(QtCore.Qt.Horizontal)
        self.sldrBrillo.setObjectName("sldrBrillo")
        self.verticalLayout_5.addWidget(self.sldrBrillo)
        self.lblContraste = QtWidgets.QLabel(self.panelSliders)
        font = QtGui.QFont()
        font.setPointSize(10)
        self.lblContraste.setFont(font)
        self.lblContraste.setStyleSheet("color:rgb(255, 255, 255)")
        self.lblContraste.setObjectName("lblContraste")
        self.verticalLayout_5.addWidget(self.lblContraste)
        self.sldrContraste = QtWidgets.QSlider(self.panelSliders)
        self.sldrContraste.setOrientation(QtCore.Qt.Horizontal)
        self.sldrContraste.setObjectName("sldrContraste")
        self.verticalLayout_5.addWidget(self.sldrContraste)
        self.lblSaturacion = QtWidgets.QLabel(self.panelSliders)
        font = QtGui.QFont()
        font.setPointSize(10)
        self.lblSaturacion.setFont(font)
        self.lblSaturacion.setStyleSheet("color:rgb(255, 255, 255)")
        self.lblSaturacion.setObjectName("lblSaturacion")
        self.verticalLayout_5.addWidget(self.lblSaturacion)
        self.sldrSaturacion = QtWidgets.QSlider(self.panelSliders)
        self.sldrSaturacion.setOrientation(QtCore.Qt.Horizontal)
        self.sldrSaturacion.setObjectName("sldrSaturacion")
        self.verticalLayout_5.addWidget(self.sldrSaturacion)
        self.lblExposicion = QtWidgets.QLabel(self.panelSliders)
        font = QtGui.QFont()
        font.setPointSize(10)
        self.lblExposicion.setFont(font)
        self.lblExposicion.setStyleSheet("color:rgb(255, 255, 255)")
        self.lblExposicion.setObjectName("lblExposicion")
        self.verticalLayout_5.addWidget(self.lblExposicion)
        self.sldrExposicion = QtWidgets.QSlider(self.panelSliders)
        self.sldrExposicion.setOrientation(QtCore.Qt.Horizontal)
        self.sldrExposicion.setObjectName("sldrExposicion")
        self.verticalLayout_5.addWidget(self.sldrExposicion)
        self.verticalLayout_5.setStretch(1, 1)
        self.verticalLayout_5.setStretch(2, 1)
        self.verticalLayout_5.setStretch(3, 1)
        self.verticalLayout_5.setStretch(4, 1)
        self.verticalLayout_5.setStretch(5, 1)
        self.verticalLayout_5.setStretch(6, 1)
        self.verticalLayout_5.setStretch(7, 1)
        self.verticalLayout_5.setStretch(8, 1)
        self.verticalLayout_2.addWidget(self.panelSliders)
        self.panelPropiedades = QtWidgets.QFrame(self.seccionesControles)
        self.panelPropiedades.setFrameShape(QtWidgets.QFrame.StyledPanel)
        self.panelPropiedades.setFrameShadow(QtWidgets.QFrame.Raised)
        self.panelPropiedades.setObjectName("panelPropiedades")
        self.verticalLayout_3 = QtWidgets.QVBoxLayout(self.panelPropiedades)
        self.verticalLayout_3.setObjectName("verticalLayout_3")
        self.propiedadesSubtitulo = QtWidgets.QLabel(self.panelPropiedades)
        font = QtGui.QFont()
        font.setPointSize(12)
        font.setBold(True)
        font.setWeight(75)
        self.propiedadesSubtitulo.setFont(font)
        self.propiedadesSubtitulo.setStyleSheet("color:rgb(255, 255, 255)")
        self.propiedadesSubtitulo.setObjectName("propiedadesSubtitulo")
        self.verticalLayout_3.addWidget(self.propiedadesSubtitulo)
        self.panelInfo = QtWidgets.QFrame(self.panelPropiedades)
        self.panelInfo.setFrameShape(QtWidgets.QFrame.StyledPanel)
        self.panelInfo.setFrameShadow(QtWidgets.QFrame.Raised)
        self.panelInfo.setObjectName("panelInfo")
        self.gridLayout = QtWidgets.QGridLayout(self.panelInfo)
        self.gridLayout.setObjectName("gridLayout")
        self.lblAncho = QtWidgets.QLabel(self.panelInfo)
        self.lblAncho.setStyleSheet("color:rgb(255, 255, 255)")
        self.lblAncho.setObjectName("lblAncho")
        self.gridLayout.addWidget(self.lblAncho, 0, 0, 1, 1)
        self.anchoValor = QtWidgets.QLabel(self.panelInfo)
        self.anchoValor.setStyleSheet("color:rgb(255, 255, 255)")
        self.anchoValor.setObjectName("anchoValor")
        self.gridLayout.addWidget(self.anchoValor, 0, 1, 1, 1)
        self.lblAlto = QtWidgets.QLabel(self.panelInfo)
        self.lblAlto.setStyleSheet("color:rgb(255, 255, 255)")
        self.lblAlto.setObjectName("lblAlto")
        self.gridLayout.addWidget(self.lblAlto, 1, 0, 1, 1)
        self.altoValor = QtWidgets.QLabel(self.panelInfo)
        self.altoValor.setStyleSheet("color:rgb(255, 255, 255)")
        self.altoValor.setObjectName("altoValor")
        self.gridLayout.addWidget(self.altoValor, 1, 1, 1, 1)
        self.lblColor = QtWidgets.QLabel(self.panelInfo)
        self.lblColor.setStyleSheet("color:rgb(255, 255, 255)")
        self.lblColor.setObjectName("lblColor")
        self.gridLayout.addWidget(self.lblColor, 2, 0, 1, 1)
        self.colorValor = QtWidgets.QLabel(self.panelInfo)
        self.colorValor.setStyleSheet("color:rgb(255, 255, 255)")
        self.colorValor.setObjectName("colorValor")
        self.gridLayout.addWidget(self.colorValor, 2, 1, 1, 1)
        self.lblResolucion = QtWidgets.QLabel(self.panelInfo)
        self.lblResolucion.setStyleSheet("color:rgb(255, 255, 255)")
        self.lblResolucion.setObjectName("lblResolucion")
        self.gridLayout.addWidget(self.lblResolucion, 3, 0, 1, 1)
        self.resolucionValor = QtWidgets.QLabel(self.panelInfo)
        self.resolucionValor.setStyleSheet("color:rgb(255, 255, 255)")
        self.resolucionValor.setObjectName("resolucionValor")
        self.gridLayout.addWidget(self.resolucionValor, 3, 1, 1, 1)
        self.gridLayout.setColumnStretch(0, 2)
        self.gridLayout.setColumnStretch(1, 1)
        self.verticalLayout_3.addWidget(self.panelInfo)
        self.verticalLayout_3.setStretch(0, 1)
        self.verticalLayout_3.setStretch(1, 4)
        self.verticalLayout_2.addWidget(self.panelPropiedades)
        self.verticalLayout_2.setStretch(0, 1)
        self.verticalLayout_2.setStretch(1, 6)
        self.verticalLayout_2.setStretch(2, 3)
        self.horizontalLayout_2.addWidget(self.seccionesControles)
        self.horizontalLayout.addWidget(self.panelHerramientas)
        self.panelCentral = QtWidgets.QFrame(self.framePaneles)
        self.panelCentral.setLayoutDirection(QtCore.Qt.LeftToRight)
        self.panelCentral.setFrameShape(QtWidgets.QFrame.StyledPanel)
        self.panelCentral.setFrameShadow(QtWidgets.QFrame.Raised)
        self.panelCentral.setObjectName("panelCentral")
        self.verticalLayout_6 = QtWidgets.QVBoxLayout(self.panelCentral)
        self.verticalLayout_6.setObjectName("verticalLayout_6")
        self.controles = QtWidgets.QFrame(self.panelCentral)
        self.controles.setFrameShape(QtWidgets.QFrame.StyledPanel)
        self.controles.setFrameShadow(QtWidgets.QFrame.Raised)
        self.controles.setObjectName("controles")
        self.horizontalLayout_9 = QtWidgets.QHBoxLayout(self.controles)
        self.horizontalLayout_9.setObjectName("horizontalLayout_9")
        self.controlesZoom = QtWidgets.QFrame(self.controles)
        self.controlesZoom.setFrameShape(QtWidgets.QFrame.StyledPanel)
        self.controlesZoom.setFrameShadow(QtWidgets.QFrame.Raised)
        self.controlesZoom.setObjectName("controlesZoom")
        self.horizontalLayout_10 = QtWidgets.QHBoxLayout(self.controlesZoom)
        self.horizontalLayout_10.setObjectName("horizontalLayout_10")
        self.zoomOut = QtWidgets.QToolButton(self.controlesZoom)
        self.zoomOut.setStyleSheet("background-color:rgb(24, 24, 24)")
        icon3 = QtGui.QIcon()
        icon3.addPixmap(QtGui.QPixmap("iconos/alejar.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.zoomOut.setIcon(icon3)
        self.zoomOut.setObjectName("zoomOut")
        self.horizontalLayout_10.addWidget(self.zoomOut)
        self.zoom = QtWidgets.QLabel(self.controlesZoom)
        self.zoom.setStyleSheet("background-color:rgb(24, 24, 24); color:rgb(255, 255, 255)")
        self.zoom.setFrameShape(QtWidgets.QFrame.NoFrame)
        self.zoom.setFrameShadow(QtWidgets.QFrame.Plain)
        self.zoom.setObjectName("zoom")
        self.horizontalLayout_10.addWidget(self.zoom)
        self.zoomIn = QtWidgets.QToolButton(self.controlesZoom)
        self.zoomIn.setStyleSheet("background-color:rgb(24, 24, 24)")
        icon4 = QtGui.QIcon()
        icon4.addPixmap(QtGui.QPixmap("iconos/dar-un-golpe-de-zoom.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.zoomIn.setIcon(icon4)
        self.zoomIn.setObjectName("zoomIn")
        self.horizontalLayout_10.addWidget(self.zoomIn)
        self.refresh = QtWidgets.QToolButton(self.controlesZoom)
        self.refresh.setStyleSheet("background-color:rgb(24, 24, 24)")
        icon5 = QtGui.QIcon()
        icon5.addPixmap(QtGui.QPixmap("iconos/gira-a-la-derecha.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.refresh.setIcon(icon5)
        self.refresh.setObjectName("refresh")
        self.horizontalLayout_10.addWidget(self.refresh)
        self.horizontalLayout_9.addWidget(self.controlesZoom)
        spacerItem = QtWidgets.QSpacerItem(192, 20, QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Minimum)
        self.horizontalLayout_9.addItem(spacerItem)
        self.controlesGuardado = QtWidgets.QFrame(self.controles)
        self.controlesGuardado.setFrameShape(QtWidgets.QFrame.StyledPanel)
        self.controlesGuardado.setFrameShadow(QtWidgets.QFrame.Raised)
        self.controlesGuardado.setObjectName("controlesGuardado")
        self.horizontalLayout_11 = QtWidgets.QHBoxLayout(self.controlesGuardado)
        self.horizontalLayout_11.setObjectName("horizontalLayout_11")
        self.compartir = QtWidgets.QPushButton(self.controlesGuardado)
        self.compartir.setStyleSheet("background-color:rgb(24, 24, 24); color:rgb(255, 255, 255)\n"
"")
        self.compartir.setObjectName("compartir")
        self.horizontalLayout_11.addWidget(self.compartir)
        self.exportar = QtWidgets.QPushButton(self.controlesGuardado)
        self.exportar.setStyleSheet("background-color:rgb(24, 24, 24); color:rgb(255, 255, 255)")
        self.exportar.setObjectName("exportar")
        self.horizontalLayout_11.addWidget(self.exportar)
        self.horizontalLayout_9.addWidget(self.controlesGuardado)
        self.horizontalLayout_9.setStretch(0, 4)
        self.horizontalLayout_9.setStretch(1, 3)
        self.horizontalLayout_9.setStretch(2, 2)
        self.verticalLayout_6.addWidget(self.controles)

        self.imagen = QtWidgets.QFrame(self.panelCentral)

        self.imagen.setFrameShape(QtWidgets.QFrame.Box)
        self.imagen.setFrameShadow(QtWidgets.QFrame.Raised)
        self.imagen.setObjectName("imagen")

        self.verticalLayout_7 = QtWidgets.QVBoxLayout(self.imagen)
        self.verticalLayout_7.setContentsMargins(0, 0, 0, 0)
        self.verticalLayout_7.setSpacing(0)
        self.verticalLayout_7.setObjectName("verticalLayout_7")

        # Aquí reemplazamos el QGraphicsView por el visor personalizado
        self.viewer = ImageViewer(self.imagen)
        self.viewer.zoomChanged.connect(self.update_zoom_label)
        self.viewer.setObjectName("viewer")
        self.verticalLayout_7.addWidget(self.viewer)

        self.verticalLayout_6.addWidget(self.imagen)


        self.verticalLayout_6.setStretch(0, 1)
        self.verticalLayout_6.setStretch(1, 9)
        self.horizontalLayout.addWidget(self.panelCentral)
        self.panelScroll = QtWidgets.QFrame(self.framePaneles)
        self.panelScroll.setStyleSheet("background:rgb(34, 34, 34)\n"
"")
        self.panelScroll.setFrameShape(QtWidgets.QFrame.StyledPanel)
        self.panelScroll.setFrameShadow(QtWidgets.QFrame.Raised)
        self.panelScroll.setObjectName("panelScroll")
        self.verticalLayout_8 = QtWidgets.QVBoxLayout(self.panelScroll)
        self.verticalLayout_8.setContentsMargins(0, 0, 0, 0)
        self.verticalLayout_8.setSpacing(0)
        self.verticalLayout_8.setObjectName("verticalLayout_8")
        self.scrollArea = QtWidgets.QScrollArea(self.panelScroll)
        self.scrollArea.setVerticalScrollBarPolicy(QtCore.Qt.ScrollBarAlwaysOn)
        self.scrollArea.setHorizontalScrollBarPolicy(QtCore.Qt.ScrollBarAlwaysOff)
        self.scrollArea.setWidgetResizable(True)
        self.scrollArea.setObjectName("scrollArea")
        self.scrollAreaWidgetContents = QtWidgets.QWidget()
        self.scrollAreaWidgetContents.setGeometry(QtCore.QRect(0, 0, 220, 628))
        self.scrollAreaWidgetContents.setObjectName("scrollAreaWidgetContents")
        self.scrollArea.setWidget(self.scrollAreaWidgetContents)
        self.verticalLayout_8.addWidget(self.scrollArea)
        self.horizontalLayout.addWidget(self.panelScroll)
        self.horizontalLayout.setStretch(0, 2)
        self.horizontalLayout.setStretch(1, 6)
        self.horizontalLayout.setStretch(2, 2)
        self.verticalLayout.addWidget(self.framePaneles)
        self.verticalLayout.setStretch(0, 1)
        self.verticalLayout.setStretch(1, 9)
        MainWindow.setCentralWidget(self.centralwidget)
        

        self.retranslateUi(MainWindow)
        QtCore.QMetaObject.connectSlotsByName(MainWindow)

        self.viewer.load_image("imagenes/marte.tiff")
        self.viewer.resetTransform()
        self.viewer.fitInView(self.viewer.scene.itemsBoundingRect(), QtCore.Qt.KeepAspectRatio)

        self.zoomIn.clicked.connect(self.viewer.zoom_in)
        self.zoomOut.clicked.connect(self.viewer.zoom_out)
        self.refresh.clicked.connect(self.viewer.refresh_zoom)



        self.bttnCursor.clicked.connect(lambda: self.viewer.setDragMode(QtWidgets.QGraphicsView.NoDrag))
        self.bttnMover.clicked.connect(lambda: self.viewer.setDragMode(QtWidgets.QGraphicsView.ScrollHandDrag))

    def update_zoom_label(self):
        porcentaje = int(self.viewer.scale_factor*100)
        self.zoom.setText(f"{porcentaje}%")


    def retranslateUi(self, MainWindow):
        _translate = QtCore.QCoreApplication.translate
        MainWindow.setWindowTitle(_translate("MainWindow", "MainWindow"))
        self.lblTitulo.setText(_translate("MainWindow", "STELLAR PIXELS"))
        self.lineEdit.setText(_translate("MainWindow", "Buscar"))
        self.label.setText(_translate("MainWindow", "Herramientas"))
        self.bttnCursor.setText(_translate("MainWindow", "..."))
        self.bttnMover.setText(_translate("MainWindow", "..."))
        self.bttnCortar.setText(_translate("MainWindow", "..."))
        self.subtituloSliders.setText(_translate("MainWindow", "Ajustes"))
        self.lblBrillo.setText(_translate("MainWindow", "Brillo"))
        self.lblContraste.setText(_translate("MainWindow", "Contraste"))
        self.lblSaturacion.setText(_translate("MainWindow", "Saturación"))
        self.lblExposicion.setText(_translate("MainWindow", "Exposición"))
        self.propiedadesSubtitulo.setText(_translate("MainWindow", "Propiedades"))
        self.lblAncho.setText(_translate("MainWindow", "Ancho:"))
        self.anchoValor.setText(_translate("MainWindow", "ejemplo"))
        self.lblAlto.setText(_translate("MainWindow", "Alto:"))
        self.altoValor.setText(_translate("MainWindow", "ejemplo"))
        self.lblColor.setText(_translate("MainWindow", "Modo de color:"))
        self.colorValor.setText(_translate("MainWindow", "ejemplo"))
        self.lblResolucion.setText(_translate("MainWindow", "Resolucion:"))
        self.resolucionValor.setText(_translate("MainWindow", "ejemplo"))
        self.zoomOut.setText(_translate("MainWindow", "..."))
        self.zoom.setText(_translate("MainWindow", "100%"))
        self.zoomIn.setText(_translate("MainWindow", "..."))
        self.refresh.setText(_translate("MainWindow", "..."))
        self.compartir.setText(_translate("MainWindow", "Compartir"))
        self.exportar.setText(_translate("MainWindow", "Exportar"))


if __name__ == "__main__":
    import sys
    app = QtWidgets.QApplication(sys.argv)
    MainWindow = QtWidgets.QMainWindow()
    ui = Ui_MainWindow()
    ui.setupUi(MainWindow)
    MainWindow.show()
    sys.exit(app.exec_())
